<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Malicious SHA-1</title>
  <style type="text/css">
  html,body 
  {
  color:#fff;
  background-color:black;
  font-family:sans-serif;
  }
  
  h1
  {
  font-size:275%;
  }
  
  a:link {color:#f00; text-decoration:none;}
  a:visited {color:#f00; text-decoration:none;}
  a:hover {color:#f00; text-decoration:none}
  </style>
</head>
<body>
<div id="header">
<h1 class="title">Malicious SHA-1</h1>
</div>
<nav>
<hr />
<big> <b> <a href="#details">Technical details</a>    <a href="#downloads">Downloads</a>    <a href="#faq">FAQ</a> </b> </big>
<hr />
</nav>
<p>This is the webpage of the Malicious SHA-1 project, a research project that demonstrates how the security of the <a href="TBD">SHA-1</a> hashing standard can be <em>fully compromised</em> if one slightly tweaks some of the predefined constants in the SHA-1 algorithm. That is, we show that applications using “custom” versions of SHA-1 may include backdoors exploitable by the application designers (and only them). Such “custom” versions are typically found in proprietary systems as a way to personalize the cryptography for a given customer, while retaining the security guarantees of the original algorithm.</p>
<p>The colliding messages constructed can be valid archives files (RAR or 7zip) such that the content of the two archives can be fully controlled. We also build colliding JPEG files, which can be any two images, as in the example below:</p>
<div class="figure">
<img src="" alt="example" /><p class="caption">example</p>
</div>
<p>We can also construct <em>colliding executables</em>, which MBR (Master Boot Record) or COM files including arbitrary code. Furthermore, we present <em>polyglot</em> collisions, that is, two distinct files that are each both valid MBR code, RAR archives, and shell script; and such that the respective content of each of those three file formats can be fully controlled, independently of the other formats.</p>
<p>Implications of this research are discussed in our <a href="#faq">FAQ</a>.</p>
<p>The Malicious SHA-1 project is a joint work of</p>
<ul>
<li><a href="https://code.google.com/p/corkami/">Ange Albertini</a></li>
<li><a href="https://131002.net">Jean-Philippe Aumasson</a></li>
<li><a href="">Maria Eichlseder</a></li>
<li><a href="">Florian Mendel</a></li>
<li><a href="">Martin Schlaeffer</a></li>
</ul>
<h2 id="technical-details">Technical details</h2>
<name ="details"/>
<p>The security of a cryptographic hash function such as SHA-1 relies on the practical impossibility to find collisions, that is, distinct messages having the same hash value. We thus show that, with only minor tweaks of the SHA-1 specifications (namely, about 40 bits of the 128-bit predefined constants),</p>
<p>Full details can be found in the <a href="malsha1-yyyymmdd.pdf">research paper</a>.</p>
<h2 id="downloads">Downloads</h2>
<name ="downloads"/>
<h2 id="faq">FAQ</h2>
<name ="faq"/>
<h3 id="what-are-the-implications-for-sha-1s-security">What are the implications for SHA-1’s security?</h3>
<p>None.</p>
<p>The differential cryptanalysis techniques used to find our collisions are inspired and derived from the best known attacks on the original SHA-1, and do not lead to improved attacks on SHA-1 (as far as we can tell).</p>
<h3 id="did-nsa-use-this-trick-when-creating-sha-1-in-1995">Did NSA use this trick when creating SHA-1 in 1995?</h3>
<p>We believe this is unlikely, for</p>
<ol style="list-style-type: decimal">
<li><p>Our results rely on state-of-the-art differential cryptanalysis research, as of 2014, based on techniques that were only publicly developed since around 2004</p></li>
<li><p>Just before SHA-1, NSA designed SHA-0, for which weaknesses were quickly identified by the research community and actual collisions presented later, in 1998; this negligence does not suggest extraordinary cryptanalysis abilities from NSA back then</p></li>
</ol>
<h3 id="can-you-do-the-same-for-sha-256">Can you do the same for SHA-256?</h3>
<p>Not at the moment.</p>
<p><a href="">SHA-256</a> is a much different case, for</p>
<ol style="list-style-type: decimal">
<li><p>SHA-256 uses 64 distinct constants for each of its 64 steps, whereas SHA-1 uses 4 distinct constants for each 20-step “round” of its 80-step construction. This provides much more freedom to sabotage the algorithm, however this will likely imply many more differences (in terms of Hamming weight) than in the case of SHA-1.</p></li>
<li><p>Whereas theoretical attacks are known on the full, 80-step, SHA-1, the best known collision attacks on SHA-256 are on <a href="TBD">31 steps only</a>, of 64 steps in total. It may thus be difficult to find a 64-step characteristics exploitable to build a malicious SHA-256.</p></li>
</ol>
</body>
</html>
